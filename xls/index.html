<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>XlsTicFactory - Ticdat</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "XlsTicFactory";
        var mkdocs_page_input_path = "xls.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Ticdat
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">pandatfactory.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../pandatfactory/">PanDatFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">pandatio.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../pandatio/">CsvPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pandatio/">JsonPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pandatio/">SqlPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pandatio/">XlsPanFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ticdatfactory.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ticdatfactory/">TicDatFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">csvtd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../csvtd/">CsvTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">jsontd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../jsontd/">JsonTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">mdb.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../mdb/">MdbTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">pgtd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../pgtd/">PostgresPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pgtd/">PostgresTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">sqlitetd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../sqlitetd/">SQLiteTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">xls.py</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">XlsTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">utils.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../utils/">Utilities</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">model.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../model/">Model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">opl.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../opl/">OPL</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Ticdat</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>xls.py &raquo;</li>
      <li class="breadcrumb-item active">XlsTicFactory</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ticdat/ticdat/edit/master/docs/xls.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ticdat.xls.XlsTicFactory">XlsTicFactory</h1>

<pre><code class="language-python">XlsTicFactory(self, tic_dat_factory)
</code></pre>
<p>Primary class for reading/writing Excel files with TicDat objects.
Your system will need the xlrd package to read .xls files, the openpyxl package
to read xlsx/xlsm/xltx/xltm files, the xlwt package to write .xls files, and the xlsxwriter
package to write .xlsx files.
Don't create this object explicitly. A XlsTicDatFactory will
automatically be associated with the xls attribute of the parent
TicDatFactory.</p>
<h2 id="ticdat.xls.XlsTicFactory.create_tic_dat">create_tic_dat</h2>

<pre><code class="language-python">XlsTicFactory.create_tic_dat(xls_file_path,
                             row_offsets=None,
                             headers_present=True,
                             treat_inf_as_infinity=True,
                             freeze_it=False)
</code></pre>
<p>Create a TicDat object from an Excel file</p>
<p>:param xls_file_path: An Excel file containing sheets whose names match
                      the table names in the schema.</p>
<p>:param row_offsets: (optional) A mapping from table names to initial
                    number of rows to skip</p>
<p>:param headers_present: Boolean. Does the first row of data contain the
                        column headers?</p>
<p>:param treat_inf_as_infinity: Boolean. Treat the "inf" string (case insensitive) as
                                       as infinity. Similar for "-inf"</p>
<p>:param freeze_it: boolean. should the returned object be frozen?</p>
<p>:return: a TicDat object populated by the matching sheets.</p>
<p>caveats: Missing sheets resolve to an empty table, but missing fields
         on matching sheets throw an Exception.
         Sheet names are considered case insensitive, and white space is replaced
         with underscore for table name matching.
         Field names are considered case insensitive, but white space is respected.
         (ticdat supports whitespace in field names but not table names).
         The following two caveats apply only if data_types are used.
         --&gt; Any field for which an empty string is invalid data and None is
             valid data will replace the empty string with None.
         --&gt; Any field for which must_be_int is true will replace numeric
             data that satisfies int(x)==x with int(x). In other words,
             the ticdat equivalent of pandas.read_excel convert_float
             is to set must_be_int to true in data_types.</p>
<h2 id="ticdat.xls.XlsTicFactory.find_duplicates">find_duplicates</h2>

<pre><code class="language-python">XlsTicFactory.find_duplicates(xls_file_path,
                              row_offsets={},
                              headers_present=True)
</code></pre>
<p>Find the row counts for duplicated rows.</p>
<p>:param xls_file_path: An Excel file containing sheets whose names match
                      the table names in the schema (non primary key tables ignored).</p>
<p>:param row_offsets: (optional) A mapping from table names to initial
                    number of rows to skip (non primary key tables ignored)</p>
<p>:param headers_present: Boolean. Does the first row of data contain the
                        column headers?</p>
<p>caveats: Missing sheets resolve to an empty table, but missing primary fields
         on matching sheets throw an Exception.
         Sheet names are considered case insensitive.</p>
<p>:return: A dictionary whose keys are the table names for the primary key tables.
         Each value of the return dictionary is itself a dictionary.
         The inner dictionary is keyed by the primary key values encountered
         in the table, and the value is the count of records in the
         Excel sheet with this primary key.
         Row counts smaller than 2 are pruned off, as they aren't duplicates</p>
<h2 id="ticdat.xls.XlsTicFactory.write_file">write_file</h2>

<pre><code class="language-python">XlsTicFactory.write_file(tic_dat,
                         file_path,
                         allow_overwrite=False,
                         case_space_sheet_names=False)
</code></pre>
<p>write the ticDat data to an excel file</p>
<p>:param tic_dat: the data object to write (typically a TicDat)</p>
<p>:param file_path: The file path of the excel file to create
                  Needs to end in either ".xls" or ".xlsx"
                  The latter is capable of writing out larger tables,
                  but the former handles infinity seamlessly.
                  If ".xlsx" then be advised that +/- float("inf") will be replaced
                  with "inf"/"-inf", unless infinity_io_flag is being applied.</p>
<p>:param allow_overwrite: boolean - are we allowed to overwrite an
                        existing file?
      case_space_sheet_names: boolean - make best guesses how to add spaces and upper case
                              characters to sheet names</p>
<p>:return:</p>
<p>caveats: None may be written out as an empty string. This reflects the behavior of xlwt.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../sqlitetd/" class="btn btn-neutral float-left" title="SQLiteTicFactory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../utils/" class="btn btn-neutral float-right" title="Utilities">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ticdat/ticdat" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../sqlitetd/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../utils/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
