<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>XlsPanFactory - Ticdat</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "XlsPanFactory";
        var mkdocs_page_input_path = "pandatio.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Ticdat
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">pandatfactory.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../pandatfactory/">PanDatFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">pandatio.py</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="./">CsvPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="./">JsonPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="./">SqlPanFactory</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">XlsPanFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ticdatfactory.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ticdatfactory/">TicDatFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">csvtd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../csvtd/">CsvTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">jsontd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../jsontd/">JsonTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">mdb.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../mdb/">MdbTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">pgtd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../pgtd/">PostgresPanFactory</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pgtd/">PostgresTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">sqlitetd.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../sqlitetd/">SQLiteTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">xls.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../xls/">XlsTicFactory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">utils.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../utils/">Utilities</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">model.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../model/">Model</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">opl.py</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../opl/">OPL</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Ticdat</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>pandatio.py &raquo;</li>
      <li class="breadcrumb-item active">XlsPanFactory</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ticdat/ticdat/edit/master/docs/pandatio.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ticdat.pandatio.CsvPanFactory">CsvPanFactory</h1>

<pre><code class="language-python">CsvPanFactory(self, pan_dat_factory)
</code></pre>
<p>Primary class for reading/writing csv files with PanDat objects.
Don't create this object explicitly. A CsvPanFactory will
automatically be associated with the csv attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.CsvPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="language-python">CsvPanFactory.create_pan_dat(dir_path,
                             fill_missing_fields=False,
                             **kwargs)
</code></pre>
<p>Create a PanDat object from a directory of csv files.</p>
<p>:param db_file_path: the directory containing the .csv files.</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:param kwargs: additional named arguments to pass to pandas.read_csv</p>
<p>:return: a PanDat object populated by the matching tables.</p>
<p>caveats: Missing tables always throw an Exception.
         Table names are matched with case-space insensitivity, but spaces
         are respected for field names.
         (ticdat supports whitespace in field names but not table names).</p>
<p>Note that if you save a DataFrame to csv and then recover it, the type of data might change. For example</p>
<pre><code>df = pd.DataFrame({"a":["100", "200", "300"]})
df.to_csv("something.csv")
df2 = pd.read_csv("something.csv")
</code></pre>
<p>results in a numeric column in df2. To address this, you need to either use set_data_type for your
PanDatFactory, or specify "dtype" in kwargs. (The former is obviously better).</p>
<p>This problem is even worse with df = pd.DataFrame({"a":["0100", "1200", "2300"]})</p>
<h2 id="ticdat.pandatio.CsvPanFactory.write_directory">write_directory</h2>

<pre><code class="language-python">CsvPanFactory.write_directory(pan_dat,
                              dir_path,
                              case_space_table_names=False,
                              index=False,
                              **kwargs)
</code></pre>
<p>write the PanDat data to a collection of csv files</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param dir_path: the directory in which to write the csv files
                     Set to falsey if using con argument.</p>
<p>:param case_space_table_names: boolean - make best guesses how to add spaces and upper case
                               characters to table names</p>
<p>:param index: boolean - whether or not to write the index.</p>
<p>:param kwargs: additional named arguments to pass to pandas.to_csv</p>
<p>:return:</p>
<p>caveats: The row names (index) isn't written (unless kwargs indicates it should be).</p>
<h1 id="ticdat.pandatio.JsonPanFactory">JsonPanFactory</h1>

<pre><code class="language-python">JsonPanFactory(self, pan_dat_factory)
</code></pre>
<p>Primary class for reading/writing json data with PanDat objects.
Don't create this object explicitly. A JsonPanFactory will
automatically be associated with the json attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.JsonPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="language-python">JsonPanFactory.create_pan_dat(path_or_buf,
                              fill_missing_fields=False,
                              orient='split',
                              **kwargs)
</code></pre>
<p>Create a PanDat object from a JSON file or string</p>
<p>:param path_or_buf:  a valid JSON string or file-like</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception. Doesn't work with list-of-lists format.</p>
<p>:param orient: Indication of expected JSON string format. See pandas.read_json for more details.</p>
<p>:param kwargs: additional named arguments to pass to pandas.read_json</p>
<p>:return: a PanDat object populated by the matching tables.</p>
<p>caveats: Missing tables always resolve to an empty table.</p>
<pre><code>     Table names are matched with case-space insensitivity, but spaces
     are respected for field names.

     (ticdat supports whitespace in field names but not table names).
</code></pre>
<p>Note that if you save a DataFrame to json and then recover it, the type of data might change.
Specifically, text that looks numeric might be recovered as a number, to include the loss of leading zeros.
To address this, you need to either use set_data_type for your
PanDatFactory, or specify "dtype" in kwargs. (The former is obviously better).</p>
<h2 id="ticdat.pandatio.JsonPanFactory.write_file">write_file</h2>

<pre><code class="language-python">JsonPanFactory.write_file(pan_dat, json_file_path)
</code></pre>
<p>Write the PanDat data to a json file (or json string). Writes each table as a list-of-lists.
See write_file_pd for other formats.</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param json_file_path: the json file into which the data is to be written. If falsey, will return a
                       JSON string</p>
<p>:return: A JSON string if json_file_path is falsey, otherwise None</p>
<h2 id="ticdat.pandatio.JsonPanFactory.write_file_pd">write_file_pd</h2>

<pre><code class="language-python">JsonPanFactory.write_file_pd(pan_dat,
                             json_file_path,
                             case_space_table_names=False,
                             orient='split',
                             index=False,
                             indent=2,
                             sort_keys=False,
                             **kwargs)
</code></pre>
<p>write the PanDat data to a json file (or json string).
Use this routine to write json text that is consistent with what pandas.to_json.
The list-of-lists format is created with write_file. In older ticdat releases, write_file
implemented the functionaltiy now provided with write_file_pd.</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param json_file_path: the json file into which the data is to be written. If falsey, will return a
                       JSON  string</p>
<p>:param case_space_table_names: boolean - make best guesses how to add spaces and upper case
                               characters to table names</p>
<p>:param orient: Passed through to pandas.to_json. Default of "split", combined with index=False, writes
               a smaller json file.</p>
<p>:param index: boolean - whether or not to write the index.</p>
<p>:param indent: 2. See json.dumps</p>
<p>:param sort_keys: See json.dumps</p>
<p>:param kwargs: additional named arguments to pass to pandas.to_json</p>
<p>:return:</p>
<p>NB - pandas seems stubbornly unable to inject Infinity into json, but it can read Infinity from
json. We work around this with a GUID created flagging string when encountering float("inf"), float(-"inf").</p>
<h1 id="ticdat.pandatio.SqlPanFactory">SqlPanFactory</h1>

<pre><code class="language-python">SqlPanFactory(self, pan_dat_factory)
</code></pre>
<p>Primary class for reading/writing SQLite files with PanDat objects.
Don't create this object explicitly. A SqlPanFactory will
automatically be associated with the sql attribute of the parent
PanDatFactory.</p>
<h2 id="ticdat.pandatio.SqlPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="language-python">SqlPanFactory.create_pan_dat(db_file_path,
                             con=None,
                             fill_missing_fields=False)
</code></pre>
<p>Create a PanDat object from a SQLite database file</p>
<p>:param db_file_path: A SQLite DB File. Set to falsey if using con argument</p>
<p>:param con: A connection object that can be passed to pandas read_sql.
            Set to falsey if using db_file_path argument.</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:return: a PanDat object populated by the matching tables.</p>
<p>caveats: Missing tables always resolve to an empty table, but missing fields on matching tables throw
         an exception (unless fill_missing_fields is truthy).</p>
<pre><code>     Table names are matched with case-space insensitivity, but spaces
     are respected for field names.
     (ticdat supports whitespace in field names but not table names).
</code></pre>
<h2 id="ticdat.pandatio.SqlPanFactory.write_file">write_file</h2>

<pre><code class="language-python">SqlPanFactory.write_file(pan_dat,
                         db_file_path,
                         con=None,
                         if_exists='replace',
                         case_space_table_names=False)
</code></pre>
<p>write the PanDat data to an excel file</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param db_file_path: The file path of the SQLite file to create.
                     Set to falsey if using con argument.</p>
<p>:param con: A connection object that can be passed to pandas to_sql.
            Set to falsey if using db_file_path argument</p>
<p>:param if_exists: ‘fail’, ‘replace’ or ‘append’. How to behave if the table already exists</p>
<p>:param case_space_table_names: boolean - make best guesses how to add spaces and upper case
                                  characters to table names</p>
<p>:return:</p>
<p>caveats: The row names (index) isn't written. The default pandas schema generation is used,
         and thus foreign key relationships aren't written.</p>
<h1 id="ticdat.pandatio.XlsPanFactory">XlsPanFactory</h1>

<pre><code class="language-python">XlsPanFactory(self, pan_dat_factory)
</code></pre>
<p>Primary class for reading/writing Excel files with panDat objects.
Don't create this object explicitly. A XlsPanFactory will automatically be associated
with the xls attribute of the parent PanDatFactory.</p>
<h2 id="ticdat.pandatio.XlsPanFactory.create_pan_dat">create_pan_dat</h2>

<pre><code class="language-python">XlsPanFactory.create_pan_dat(xls_file_path, fill_missing_fields=False)
</code></pre>
<p>Create a PanDat object from an Excel file</p>
<p>:param xls_file_path: An Excel file containing sheets whose names match
                      the table names in the schema.</p>
<p>:param fill_missing_fields: boolean. If truthy, missing fields will be filled in
                            with their default value. Otherwise, missing fields
                            throw an Exception.</p>
<p>:return: a PanDat object populated by the matching sheets.</p>
<p>caveats: Missing sheets resolve to an empty table, but missing fields
         on matching sheets throw an Exception (unless fill_missing_fields is truthy).
         Table names are matched to sheets with with case-space insensitivity, but spaces and
         case are respected for field names.
         (ticdat supports whitespace in field names but not table names).</p>
<p>Note that if you save a DataFrame to excel and then recover it, the type of data might change. For example</p>
<pre><code>df = pd.DataFrame({"a":["100", "200", "300"]})
df.to_excel("something.xlsx")
df2 = pd.read_excel("something.xlsx")
</code></pre>
<p>results in a numeric column in df2. To address this, you need to use set_data_type for your
PanDatFactory.</p>
<p>This problem is even worse with df = pd.DataFrame({"a":["0100", "1200", "2300"]})</p>
<h2 id="ticdat.pandatio.XlsPanFactory.write_file">write_file</h2>

<pre><code class="language-python">XlsPanFactory.write_file(pan_dat,
                         file_path,
                         case_space_sheet_names=False)
</code></pre>
<p>write the panDat data to an excel file</p>
<p>:param pan_dat: the PanDat object to write</p>
<p>:param file_path: The file path of the excel file to create</p>
<p>:param case_space_sheet_names: boolean - make best guesses how to add spaces and upper case
                              characters to sheet names</p>
<p>:return:</p>
<p>caveats: The row names (index) isn't written.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="./" class="btn btn-neutral float-left" title="SqlPanFactory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ticdatfactory/" class="btn btn-neutral float-right" title="TicDatFactory">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ticdat/ticdat" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="./" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ticdatfactory/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
